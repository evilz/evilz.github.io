<!DOCTYPE html>
<html ⚡ lang="en">
  <head>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,700|Lora:400,700' rel='stylesheet' type='text/css'>
  <script async custom-element="amp-youtube" src="https://cdn.ampproject.org/v0/amp-youtube-0.1.js"></script>
  <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
  <script async custom-element="amp-gist" src="https://cdn.ampproject.org/v0/amp-gist-0.1.js"></script>
  <script async custom-element="amp-twitter" src="https://cdn.ampproject.org/v0/amp-twitter-0.1.js"></script>
  <script async custom-element="amp-install-serviceworker" src="https://cdn.ampproject.org/v0/amp-install-serviceworker-0.1.js"></script>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">
  <meta name="theme-color" content="#ffffff">

  <title>TechDays 2011, LA PROGRAMMATION ASYNCHRONE - PART I - REACTIVE EXTENSIONS</title>
  <meta name="description" content="Premier jour des Techdays 2011, pour ma première session je vais assister à une présentation du Framework Reactive Extensions ou Rx créé par les DevLab Micro...">

  <link rel="canonical" href="https://www.evilznet.com/2011/02/11/techdays-2011-la-programmation-asynchrone-part-i-reactive-extensions/">
  <link rel="alternate" type="application/rss+xml" title="Evilz blog" href="https://www.evilznet.com/feed.xml">
  <link rel="manifest" href="/manifest.json">

  <script type="application/ld+json">
  
{
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": "https://www.evilznet.com/2011/02/11/techdays-2011-la-programmation-asynchrone-part-i-reactive-extensions/",
  "headline": "TechDays 2011, LA PROGRAMMATION ASYNCHRONE - PART I - REACTIVE EXTENSIONS",
  "datePublished": "2011-02-11T08:49:00+00:00",
  "dateModified": "2011-02-11T08:49:00+00:00",
  "description": "Premier jour des Techdays 2011, pour ma première session je vais assister à une présentation du Framework Reactive Extensions ou Rx créé par les DevLab Micro...",
  "author": {
    "@type": "Person",
    "name": "Vincent Bourdon"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Evilz blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.evilznet.com/assets/images/logo.jpg",
      "width": "60",
      "height": "60"
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "https://www.evilznet.com/assets/images/logo.jpg",
    "height": "60",
    "width": "60"
  }
}

  </script>

  <style amp-custom>
  
  /**
 * Syntax highlighting styles
 */
.highlight {
  background: #fff;
  /* Comment */
  /* Error */
  /* Keyword */
  /* Operator */
  /* Comment.Multiline */
  /* Comment.Preproc */
  /* Comment.Single */
  /* Comment.Special */
  /* Generic.Deleted */
  /* Generic.Emph */
  /* Generic.Error */
  /* Generic.Heading */
  /* Generic.Inserted */
  /* Generic.Output */
  /* Generic.Prompt */
  /* Generic.Strong */
  /* Generic.Subheading */
  /* Generic.Traceback */
  /* Keyword.Constant */
  /* Keyword.Declaration */
  /* Keyword.Namespace */
  /* Keyword.Pseudo */
  /* Keyword.Reserved */
  /* Keyword.Type */
  /* Literal.Number */
  /* Literal.String */
  /* Name.Attribute */
  /* Name.Builtin */
  /* Name.Class */
  /* Name.Constant */
  /* Name.Decorator */
  /* Name.Entity */
  /* Name.Exception */
  /* Name.Function */
  /* Name.Label */
  /* Name.Namespace */
  /* Name.Tag */
  /* Name.Variable */
  /* Operator.Word */
  /* Text.Whitespace */
  /* Literal.Number.Float */
  /* Literal.Number.Hex */
  /* Literal.Number.Integer */
  /* Literal.Number.Oct */
  /* Literal.String.Backtick */
  /* Literal.String.Char */
  /* Literal.String.Doc */
  /* Literal.String.Double */
  /* Literal.String.Escape */
  /* Literal.String.Heredoc */
  /* Literal.String.Interpol */
  /* Literal.String.Other */
  /* Literal.String.Regex */
  /* Literal.String.Single */
  /* Literal.String.Symbol */
  /* Name.Builtin.Pseudo */
  /* Name.Variable.Class */
  /* Name.Variable.Global */
  /* Name.Variable.Instance */
  /* Literal.Number.Integer.Long */ }
  .highlighter-rouge .highlight {
    background: #fcfcfc; }
  .highlight pre {
    background-color: #fcfcfc; }
  .highlight code {
    background-color: #fcfcfc; }
  .highlight .hll {
    background-color: #ffffcc; }
  .highlight .c {
    color: #999988;
    font-style: italic; }
  .highlight .err {
    color: #a61717;
    background-color: #e3d2d2; }
  .highlight .k {
    color: #000000;
    font-weight: bold; }
  .highlight .o {
    color: #000000;
    font-weight: bold; }
  .highlight .cm {
    color: #999988;
    font-style: italic; }
  .highlight .cp {
    color: #999999;
    font-weight: bold;
    font-style: italic; }
  .highlight .c1 {
    color: #999988;
    font-style: italic; }
  .highlight .cs {
    color: #999999;
    font-weight: bold;
    font-style: italic; }
  .highlight .gd {
    color: #000000;
    background-color: #ffdddd; }
  .highlight .ge {
    color: #000000;
    font-style: italic; }
  .highlight .gr {
    color: #aa0000; }
  .highlight .gh {
    color: #999999; }
  .highlight .gi {
    color: #000000;
    background-color: #ddffdd; }
  .highlight .go {
    color: #888888; }
  .highlight .gp {
    color: #555555; }
  .highlight .gs {
    font-weight: bold; }
  .highlight .gu {
    color: #aaaaaa; }
  .highlight .gt {
    color: #aa0000; }
  .highlight .kc {
    color: #000000;
    font-weight: bold; }
  .highlight .kd {
    color: #000000;
    font-weight: bold; }
  .highlight .kn {
    color: #000000;
    font-weight: bold; }
  .highlight .kp {
    color: #000000;
    font-weight: bold; }
  .highlight .kr {
    color: #000000;
    font-weight: bold; }
  .highlight .kt {
    color: #445588;
    font-weight: bold; }
  .highlight .m {
    color: #009999; }
  .highlight .s {
    color: #d01040; }
  .highlight .na {
    color: #008080; }
  .highlight .nb {
    color: #0086B3; }
  .highlight .nc {
    color: #445588;
    font-weight: bold; }
  .highlight .no {
    color: #008080; }
  .highlight .nd {
    color: #3c5d5d;
    font-weight: bold; }
  .highlight .ni {
    color: #800080; }
  .highlight .ne {
    color: #990000;
    font-weight: bold; }
  .highlight .nf {
    color: #990000;
    font-weight: bold; }
  .highlight .nl {
    color: #990000;
    font-weight: bold; }
  .highlight .nn {
    color: #555555; }
  .highlight .nt {
    color: #000080; }
  .highlight .nv {
    color: #008080; }
  .highlight .ow {
    color: #000000;
    font-weight: bold; }
  .highlight .w {
    color: #bbbbbb; }
  .highlight .mf {
    color: #009999; }
  .highlight .mh {
    color: #009999; }
  .highlight .mi {
    color: #009999; }
  .highlight .mo {
    color: #009999; }
  .highlight .sb {
    color: #d01040; }
  .highlight .sc {
    color: #d01040; }
  .highlight .sd {
    color: #d01040; }
  .highlight .s2 {
    color: #d01040; }
  .highlight .se {
    color: #d01040; }
  .highlight .sh {
    color: #d01040; }
  .highlight .si {
    color: #d01040; }
  .highlight .sx {
    color: #d01040; }
  .highlight .sr {
    color: #009926; }
  .highlight .s1 {
    color: #d01040; }
  .highlight .ss {
    color: #990073; }
  .highlight .bp {
    color: #999999; }
  .highlight .vc {
    color: #008080; }
  .highlight .vg {
    color: #008080; }
  .highlight .vi {
    color: #008080; }
  .highlight .il {
    color: #009999; }

/* Basscss Margin */
.m0 {
  margin: 0; }

.mt0 {
  margin-top: 0; }

.mr0 {
  margin-right: 0; }

.mb0 {
  margin-bottom: 0; }

.ml0 {
  margin-left: 0; }

.mx0 {
  margin-left: 0;
  margin-right: 0; }

.my0 {
  margin-top: 0;
  margin-bottom: 0; }

.m1 {
  margin: 0.5rem; }

.mt1 {
  margin-top: 0.5rem; }

.mr1 {
  margin-right: 0.5rem; }

.mb1 {
  margin-bottom: 0.5rem; }

.ml1 {
  margin-left: 0.5rem; }

.mx1 {
  margin-left: 0.5rem;
  margin-right: 0.5rem; }

.my1 {
  margin-top: 0.5rem;
  margin-bottom: 0.5rem; }

.m2 {
  margin: 1rem; }

.mt2 {
  margin-top: 1rem; }

.mr2 {
  margin-right: 1rem; }

.mb2 {
  margin-bottom: 1rem; }

.ml2 {
  margin-left: 1rem; }

.mx2 {
  margin-left: 1rem;
  margin-right: 1rem; }

.my2 {
  margin-top: 1rem;
  margin-bottom: 1rem; }

.m3 {
  margin: 2rem; }

.mt3 {
  margin-top: 2rem; }

.mr3 {
  margin-right: 2rem; }

.mb3 {
  margin-bottom: 2rem; }

.ml3 {
  margin-left: 2rem; }

.mx3 {
  margin-left: 2rem;
  margin-right: 2rem; }

.my3 {
  margin-top: 2rem;
  margin-bottom: 2rem; }

.m4 {
  margin: 4rem; }

.mt4 {
  margin-top: 4rem; }

.mr4 {
  margin-right: 4rem; }

.mb4 {
  margin-bottom: 4rem; }

.ml4 {
  margin-left: 4rem; }

.mx4 {
  margin-left: 4rem;
  margin-right: 4rem; }

.my4 {
  margin-top: 4rem;
  margin-bottom: 4rem; }

.mxn1 {
  margin-left: -0.5rem;
  margin-right: -0.5rem; }

.mxn2 {
  margin-left: -1rem;
  margin-right: -1rem; }

.mxn3 {
  margin-left: -2rem;
  margin-right: -2rem; }

.mxn4 {
  margin-left: -4rem;
  margin-right: -4rem; }

.ml-auto {
  margin-left: auto; }

.mr-auto {
  margin-right: auto; }

.mx-auto {
  margin-left: auto;
  margin-right: auto; }

.icon > svg {
  display: inline-block;
  width: 16px;
  height: 16px;
  vertical-align: middle; }
  .icon > svg path {
    fill: #828282; }

.fixed-container {
  position: relative;
  max-width: 700px;
  height: 180px; }

.fixed-header {
  position: relative;
  max-width: 700px;
  height: 360px; }

.fixed-footer {
  position: relative;
  max-width: 300px;
  height: 80px; }

amp-img {
  background-color: #fff; }

amp-img.contain img {
  object-fit: contain; }

amp-img.cover img {
  object-fit: cover; }

.cf:after {
  content: "";
  display: table;
  clear: both; }

main {
  display: block; }

body {
  background-color: #fff;
  font-family: "Helvetica Neue", "Open Sans", Arial, Helvetica, sans-serif;
  margin: 0;
  padding: 0;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-font-feature-settings: "liga=1, dlig=1";
  -ms-font-feature-settings: "liga", "dlig";
  -webkit-font-feature-settings: "liga", "dlig";
  -o-font-feature-settings: "liga", "dlig";
  font-feature-settings: "liga", "dlig"; }

.site-header {
  position: relative;
  width: 100%;
  max-width: 700px;
  margin: 16px auto 0 auto;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box; }
  @media only screen and (max-width: 800px) {
    .site-header {
      padding: 0 16px; } }
  .site-header .page-links {
    display: block;
    position: absolute;
    top: 10px;
    right: 16px;
    font-weight: 200;
    font-style: normal;
    font-size: 18px;
    line-height: 30px; }
    .site-header .page-links a {
      text-decoration: none;
      color: #999999; }
      .site-header .page-links a:hover {
        color: #333333; }

.blog-header {
  width: 100%;
  max-width: 700px;
  margin: 0 auto;
  position: relative;
  padding: 0;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box; }
  .blog-header .blog-title {
    margin-bottom: 8px;
    font-size: 50px;
    font-weight: 700;
    letter-spacing: -2px;
    outline: 0;
    line-height: 50px;
    word-break: break-word;
    color: #333333; }
  .blog-header .blog-description {
    font-size: 28px;
    margin: 0 0 20px;
    padding: 0;
    line-height: 1.2;
    color: #666666;
    font-weight: 300; }

.content {
  width: 100%;
  max-width: 700px;
  margin: 25px auto 0 auto;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box; }
  @media only screen and (max-width: 800px) {
    .content {
      padding: 0 16px; } }
  .content article {
    padding: 20px 0;
    border-bottom: 1px solid #f2f2f0; }
    .content article:last-child {
      border-bottom: 0px; }
    .content article .post-title {
      letter-spacing: -0.02em;
      font-weight: 700;
      font-style: normal;
      display: block;
      font-size: 36px;
      line-height: 1.15;
      margin: 0 0; }
      .content article .post-title a {
        text-decoration: none;
        color: #333332; }
        .content article .post-title a:hover {
          text-decoration: none; }
    .content article .post-excerpt {
      letter-spacing: -0.02em;
      font-weight: 300;
      font-style: normal;
      font-size: 20px;
      line-height: 1.59;
      color: #666665; }
    .content article .post-meta {
      font-size: 14px;
      color: #b3b3b1;
      line-height: 30px; }
      .content article .post-meta a {
        color: #b3b3b1;
        text-decoration: none; }
        .content article .post-meta a:hover {
          text-decoration: underline; }

.post-template .content {
  max-width: 700px; }

.index-headline {
  border-top: 1px solid #dededc;
  margin: 0;
  padding: 16px 0; }
  .index-headline span {
    color: #b3b3b1;
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 1px; }

.pagination {
  text-align: center;
  padding: 16px 0 0;
  font-size: 12px; }
  .pagination a {
    color: #999999;
    text-decoration: none; }
    .pagination a:hover {
      color: #333333; }

.site-footer {
  margin: 0 auto;
  padding: 48px 0;
  width: 100%;
  max-width: 700px;
  font-size: 12px;
  text-align: center;
  color: #999999;
  line-height: 17.6px; }
  .site-footer a {
    color: #666666;
    text-decoration: none; }
    .site-footer a:hover {
      color: #333333; }

.post .post-meta {
  font-family: "Helvetica Neue", "Open Sans", Arial, Helvetica, sans-serif; }
.post .post-title {
  font-weight: 700;
  font-style: normal;
  letter-spacing: -0.04em;
  font-size: 50px;
  line-height: 1.1;
  color: #333332;
  margin-bottom: 50px; }
.post .author-image {
  background-image: url(/assets/images/logo.jpg);
  display: inline-block;
  width: 30px;
  height: 30px;
  line-height: 30px;
  margin-right: 8px;
  margin-bottom: -10px;
  float: left;
  background-size: cover;
  border-radius: 100%;
  text-indent: -9999px; }
.post .post-meta-text {
  color: #b3b3b1;
  letter-spacing: -0.02em;
  font-weight: 400;
  font-style: normal;
  font-size: 14px;
  overflow: hidden;
  font-family: "Helvetica Neue", "Open Sans", Arial, Helvetica, sans-serif;
  white-space: nowrap;
  text-overflow: ellipsis; }
.post .post-content {
  width: 100%;
  font-family: Georgia, Cambria, "Times New Roman", Times, "Lora", serif;
  color: #333333; }
  .post .post-content h1, .post .post-content h2, .post .post-content h3 {
    font-family: "Helvetica Neue", "Open Sans", Arial, Helvetica, sans-serif; }
  .post .post-content h3, .post .post-content h4, .post .post-content h5, .post .post-content h6 {
    letter-spacing: -0.02em;
    font-weight: 700;
    font-style: normal;
    font-size: 24px;
    line-height: 1.3;
    margin-top: 50px;
    margin-bottom: 0px;
    font-family: "Helvetica Neue", "Open Sans", Arial, Helvetica, sans-serif; }
  .post .post-content h3 {
    font-size: 36px; }
  .post .post-content h2, .post .post-content h1 {
    letter-spacing: -0.02em;
    font-weight: 700;
    font-style: normal;
    font-size: 42px;
    line-height: 1.2;
    margin-top: 50px;
    margin-bottom: 0px; }
  .post .post-content table {
    border-collapse: collapse; }
  .post .post-content table, .post .post-content th, .post .post-content td {
    border: 1px solid black;
    padding: 5px;
    text-align: left; }
  .post .post-content p {
    font-weight: 400;
    font-style: normal;
    font-size: 21px;
    line-height: 1.59;
    letter-spacing: -.002em;
    margin-top: 30px;
    margin-bottom: 0;
    color: #333333;
    -webkit-hyphens: auto;
    -moz-hyphens: auto;
    hyphens: auto; }
  .post .post-content a {
    color: #333333;
    text-decoration: underline; }
  .post .post-content amp-img, .post .post-content amp-youtube {
    margin-top: 30px; }
  .post .post-content figure {
    margin: 0;
    padding: 0 0 30px; }
  .post .post-content figcaption {
    font-weight: 400;
    font-style: italic;
    font-size: 16px;
    line-height: 1.3;
    color: #666665;
    outline: 0;
    z-index: 300;
    text-align: center; }
  .post .post-content hr {
    border: 0;
    padding: 0;
    display: block;
    width: 15%;
    margin: 30px auto;
    border: 0px solid #dddddd;
    border-top: 1px solid #dddddd; }
  .post .post-content blockquote {
    margin: 0 0 30px;
    margin-left: -26px;
    border-left: 3px solid #57ad68;
    padding-left: 20px; }
    .post .post-content blockquote p {
      letter-spacing: 0.01rem;
      font-weight: 400;
      mborder-left: 3px solid #57ad68;
      mpadding-left: 20px;
      mmargin-left: -26px;
      padding-bottom: 3px; }
  .post .post-content ul, .post .post-content ol {
    padding: 0 0 30px;
    margin: 0; }
  .post .post-content li {
    padding: 0;
    font-weight: 400;
    font-style: normal;
    font-size: 23px;
    line-height: 30px;
    margin-left: 30px;
    margin-bottom: 12px;
    padding-top: 2px; }
    .post .post-content li p {
      padding: 0 0 1.618rem; }
  .post .post-content ol li {
    list-style-type: decimal; }
.post .bottom-teaser {
  padding: 50px 0 0 0;
  font-family: "Helvetica Neue", "Open Sans", Arial, Helvetica, sans-serif; }
  .post .bottom-teaser hr {
    border: 0;
    padding: 0;
    display: block;
    width: 15%;
    margin: 16px 0 16px 100px;
    border: 0px solid #dddddd;
    border-top: 1px solid #dddddd; }
  .post .bottom-teaser .isLeft {
    float: left;
    width: 47%;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box; }
    @media only screen and (max-width: 800px) {
      .post .bottom-teaser .isLeft {
        width: 100%;
        padding-bottom: 32px; } }
    .post .bottom-teaser .isLeft .bio {
      margin-top: 18px;
      margin-bottom: 18px; }
    .post .bottom-teaser .isLeft .username {
      margin-left: 4px;
      margin-right: 18px;
      margin-bottom: 18px; }
    .post .bottom-teaser .isLeft .index-headline {
      padding-bottom: 32px; }
    .post .bottom-teaser .isLeft a {
      color: black;
      text-decoration: none; }
      .post .bottom-teaser .isLeft a:hover {
        color: #333333;
        text-decoration: underline; }
    .post .bottom-teaser .isLeft .author-image {
      display: block;
      width: 80px;
      height: 80px;
      float: left;
      background-size: cover;
      border-radius: 100%;
      text-indent: -9999px; }
    .post .bottom-teaser .isLeft h4 {
      font-size: 18px;
      line-height: 1.1;
      font-weight: 700;
      padding: 0;
      margin: 0;
      padding-left: 100px; }
    .post .bottom-teaser .isLeft p {
      font-size: 14px;
      line-height: 1.3;
      font-weight: 400;
      padding: 0;
      margin: 0;
      padding-left: 100px; }
      .post .bottom-teaser .isLeft p.published {
        color: #999999; }
  .post .bottom-teaser .isRight {
    float: right;
    width: 47%;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box; }
    @media only screen and (max-width: 800px) {
      .post .bottom-teaser .isRight {
        width: 100%; } }
    .post .bottom-teaser .isRight .index-headline {
      padding-bottom: 32px; }
    .post .bottom-teaser .isRight .site-footer {
      margin: 0;
      padding: 0;
      color: #333333;
      text-align: left;
      font-size: 14px;
      line-height: 1.3;
      color: #999999; }
      .post .bottom-teaser .isRight .site-footer a {
        color: #333333;
        text-decoration: none; }
        .post .bottom-teaser .isRight .site-footer a:hover {
          text-decoration: underline; }
      .post .bottom-teaser .isRight .site-footer .poweredby {
        display: block;
        padding-bottom: 18px;
        font-weight: 700;
        color: #333333; }

.share {
  text-align: right;
  padding: 20px 0 0; }
  .share a {
    text-decoration: none;
    color: #bbbbbb;
    padding-left: 12px; }
    .share a .hidden {
      display: none; }
    .share a:hover {
      color: #333333; }

pre,
code {
  font-size: 15px;
  border: 1px solid #e8e8e8;
  border-radius: 3px;
  background-color: #fcfcfc;
  color: #000000; }

code {
  padding: 1px 5px; }

pre {
  padding: 8px 12px;
  overflow-x: auto; }
  pre > code {
    border: 0;
    padding-right: 0;
    padding-left: 0; }

.pagination .disabled {
  opacity: 0; }

  </style>

  <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
  <script async src="https://cdn.ampproject.org/v0.js"></script>
</head>

  <body>
    <header class="site-header">
  <a href="/" class="logo"><span class="logo"><amp-img src="/assets/images/logo.jpg" width="48" height="48" alt="evilz logo" /></span></a>

  <div class="page-links">
    <a class="page-link" href="/">Home</a>
    
      
      • <a class="page-link" href="/intro-fable.html">Introduction a FABLE</a>
      
    
      
      • <a class="page-link" href="/about/">About</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  </div>
</header>


    <div class="feature"></div>
<main class="content" role="main">
  <article class="post">
    <div class="post-meta">
      <h1 class="post-title">TechDays 2011, LA PROGRAMMATION ASYNCHRONE - PART I - REACTIVE EXTENSIONS</h1>
    </div>

 
    <section class="post-content">
      <a name="topofpage"></a>

        <!-- Post Feature Image -->
   
   
   
   <div class="flex">
    <div class="fixed-header m1">

      <amp-img src="https://farm5.staticflickr.com/4600/24477719617_8376a0abf4_n.jpg"
      width="700"
      height="300"
      layout="fill"
      class="cover"
      alt="AMP"></amp-img>
    </div>
  </div>
  
   

   <p>Premier jour des Techdays 2011, pour ma première session je vais assister à une présentation du Framework Reactive Extensions ou Rx créé par les DevLab Microsoft.
La session est animée par Charlotte Chavancy, Jérémy Alles développeurs chez Tallès à Grenoble et Mitsu Furuta.</p>

<p>Dans l’ensemble la session a été très intéressante et très bien présentée, pas a pas.</p>

<p>Je vais donc essayer de rester dans le même esprit pour à mon tout vous démontrer la puissance de ce framework.</p>

<p>Les points importants à retenir :</p>

<ul>
  <li>Rx est stable, donc un code de production testé et approuvé</li>
  <li>
    <p>Rx est disponible pour de nombreuse techno à partir du Fx 3.5 puisqu’il s’appuie sur la syntaxe Linq  :</p>

    <ul>
      <li><a href="http://download.microsoft.com/download/2/E/E/2EE80327-1E24-4B75-A212-C097734F5F53/Rx_Net35.msi">Download Rx 1.0.2787.0 for .NET 3.5 SP1</a></li>
      <li><a href="http://download.microsoft.com/download/C/9/8/C98A3C48-D7A3-499A-B966-4FEAE43A2FE6/Rx_Net4.msi">Download Rx 1.0.2787.0 for .NET 4</a></li>
      <li><a href="http://download.microsoft.com/download/4/A/4/4A477A70-910E-430F-B83A-53C23226CEA8/Rx_SL3.msi">Download Rx 1.0.2787.0 for Silverlight 3</a></li>
      <li><a href="http://download.microsoft.com/download/C/7/F/C7F6E70C-49A8-47E5-8A31-C521953AD472/Rx_SL4.msi">Download Rx 1.0.2787.0 for Silverlight 4</a></li>
      <li><a href="http://msdn.microsoft.com/devlabs/ff628422">Download Rx 1.0.2787.0 for JavaScript</a></li>
      <li><a href="http://download.microsoft.com/download/4/D/C/4DC48C69-B4DC-46A2-9AF1-0C0F9758A0DA/Rx_All.msi">Download Rx 1.0.2787.0 for all common flavors</a></li>
      <li><a href="http://download.microsoft.com/download/E/0/D/E0D46929-6FC8-4865-94D0-514CBC1E5573/Rx_XNA4_XBOX360.msi">Download Rx 1.0.2787.0 for XNA 4 XBOX 360</a></li>
      <li><a href="http://download.microsoft.com/download/6/4/2/64228BDC-0A4F-4BDE-A4A2-3DCE6770CF6B/Rx_XNA31_Zune.msi">Download Rx 1.0.2787.0 for XNA 3.1 Zune</a></li>
      <li><a href="http://download.microsoft.com/download/1/2/4/12494C0C-7C13-4BB9-AB05-72874DC993F8/Rx_WP7.msi">Download Rx 1.0.2787.0 for Windows Phone 7</a></li>
    </ul>
  </li>
  <li>Rx peut être installé par NuGet :  PM&gt; Install-Package Rx-All</li>
</ul>

<h3 id="première-démo-">Première démo :</h3>

<p>Voici le code de base du quel nous allons partir.
Un timer est instancié est à chaque Tick on écrit la date courante dans la console.</p>

<div class="language-csharp highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">ts</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">TimeSource</span><span class="p">();</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">TimeSource</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="nf">TimeSource</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">timer</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Timer</span><span class="p">(</span><span class="k">new</span> <span class="nf">TimerCallback</span><span class="p">(</span><span class="n">Tick</span><span class="p">),</span> <span class="k">null</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1000</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="n">Timer</span> <span class="n">timer</span><span class="p">;</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">Tick</span><span class="p">(</span><span class="kt">object</span> <span class="n">state</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">try</span>
            <span class="p">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span>
            <span class="p">{</span>

            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre>
  </div>
</div>

<p>Ok ce code ne sert à rien … c’est pas le sujet !
Nous allons maintenant le modifier pour implémenté le pattern Observable, puisque Rx repose entièrement sur ce dernier.</p>

<p>Avant de vous montrer le code, une petite explication du pattern s’impose.</p>

<p>C’est finalement assez simple, un objet de type Observer implémentant IObserver va souscrire à un objet de type Observable implémentant IObservable.</p>

<p>Regardons ces deux interfaces</p>

<div class="language-csharp highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><span class="k">public</span> <span class="k">interface</span> <span class="nc">IObservable</span><span class="p">&lt;</span><span class="k">out</span> <span class="n">T</span><span class="p">&gt;</span>
<span class="p">{</span>
        <span class="n">IDisposable</span> <span class="nf">Subscribe</span><span class="p">(</span><span class="n">IObserver</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">observer</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">public</span> <span class="k">interface</span> <span class="nc">IObserver</span><span class="p">&lt;</span><span class="k">in</span> <span class="n">T</span><span class="p">&gt;</span>
<span class="p">{</span>
        <span class="k">void</span> <span class="nf">OnCompleted</span><span class="p">();</span>
        <span class="k">void</span> <span class="nf">OnError</span><span class="p">(</span><span class="n">Exception</span> <span class="n">error</span><span class="p">);</span>
        <span class="k">void</span> <span class="nf">OnNext</span><span class="p">(</span><span class="n">T</span> <span class="k">value</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>
  </div>
</div>

<p>Notre objet <code class="highlighter-rouge">Observer</code> va s’inscrire sur l’objet observable en apellant la méthode <code class="highlighter-rouge">Subscribe()</code> , puis l’observable va appeler les méthodes <code class="highlighter-rouge">OnCompleted()</code>, <code class="highlighter-rouge">OnError()</code>, <code class="highlighter-rouge">OnNext()</code> de ses observers (oui il peut y en avoir plus d’un évidemment).</p>

<div class="language-csharp highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">ts</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">TimeSource</span><span class="p">();</span>
            <span class="n">ts</span><span class="p">.</span><span class="nf">Subscribe</span><span class="p">(</span>
                        <span class="n">dt</span> <span class="p">=&gt;</span> <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">dt</span><span class="p">.</span><span class="nf">ToString</span><span class="p">()),</span> <span class="c1">// onNext</span>
                        <span class="n">ex</span> <span class="p">=&gt;</span> <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">ex</span><span class="p">.</span><span class="n">Message</span><span class="p">),</span> <span class="c1">// onError</span>
                        <span class="p">()</span> <span class="p">=&gt;</span> <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"C'est fini"</span><span class="p">)</span> <span class="c1">// onCompleted</span>
                <span class="p">);</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// notre classe observable</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">TimeSource</span> <span class="p">:</span> <span class="n">IObservable</span><span class="p">&lt;</span><span class="n">DateTime</span><span class="p">&gt;</span> <span class="p">,</span> <span class="n">IDisposable</span>
    <span class="p">{</span>
        <span class="c1">// liste des observers ayant souscrit</span>
        <span class="n">List</span><span class="p">&lt;</span><span class="n">IObserver</span><span class="p">&lt;</span><span class="n">DateTime</span><span class="p">&gt;&gt;</span> <span class="n">observers</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">IObserver</span><span class="p">&lt;</span><span class="n">DateTime</span><span class="p">&gt;&gt;();</span>
        <span class="kt">int</span> <span class="n">count</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">TimeSource</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">timer</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Timer</span><span class="p">(</span><span class="k">new</span> <span class="nf">TimerCallback</span><span class="p">(</span><span class="n">Tick</span><span class="p">),</span> <span class="k">null</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1000</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="n">Timer</span> <span class="n">timer</span><span class="p">;</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">Tick</span><span class="p">(</span><span class="kt">object</span> <span class="n">state</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">try</span>
            <span class="p">{</span>
                <span class="n">count</span><span class="p">++;</span>
                <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">obs</span> <span class="k">in</span> <span class="n">observers</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="c1">// déclenche l'action passé en paramettre pour onNext</span>
                    <span class="n">obs</span><span class="p">.</span><span class="nf">OnNext</span><span class="p">(</span><span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">);</span>

                    <span class="c1">// si le timer à Tické 10 déclenche le onCompleted</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">count</span> <span class="p">&gt;=</span> <span class="m">10</span><span class="p">)</span>
                        <span class="n">obs</span><span class="p">.</span><span class="nf">OnCompleted</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">// en cas d'erreur on déclenche le onError</span>
                <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">obs</span> <span class="k">in</span> <span class="n">observers</span><span class="p">)</span>
                    <span class="n">obs</span><span class="p">.</span><span class="nf">OnError</span><span class="p">(</span><span class="n">ex</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="n">IDisposable</span> <span class="nf">Subscribe</span><span class="p">(</span><span class="n">IObserver</span><span class="p">&lt;</span><span class="n">DateTime</span><span class="p">&gt;</span> <span class="n">observer</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// si il n'existe pas on ajout l'observer dans la collection</span>
            <span class="k">if</span><span class="p">(!</span><span class="n">observers</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="n">observer</span><span class="p">))</span>
                <span class="n">observers</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">observer</span><span class="p">);</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// IObservable neccésite l'implémentation de IDisposable</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">Dispose</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">timer</span><span class="p">.</span><span class="nf">Dispose</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre>
  </div>
</div>

<p>voici le résultat</p>

<div class="language-bash highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code>10/02/2011 12:33:32
10/02/2011 12:33:33
10/02/2011 12:33:34
10/02/2011 12:33:35
10/02/2011 12:33:36
10/02/2011 12:33:37
10/02/2011 12:33:38
10/02/2011 12:33:39
10/02/2011 12:33:40
C<span class="s1">'est fini
</span></code></pre>
  </div>
</div>

<p>Jusqu’ici rien de bien formidable. Patience on y va crescendo.</p>

<p>Revenons au principe de base, ce que l’on souhaite, c’est de faire des appels asynchrones de façon simplifiés.
Imaginons par exemple que notre application nécessite l’exécution d’une action assez longue même que l’on ne souhaite pas bloquer pour autant le thread principal.
Pour prendre un cas plus concret, lancer le téléchargement d’une image provenant de flickr sans freezer l’interface utilisateur. En winform, le backgroundWorker nous est d’une grande aide.
Cela revient à utiliser un système de callback via différents évènements.
Essayons de reproduire ce concept dans une application console via le Rx.</p>

<div class="language-csharp highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// Création d'objet observable qui apelle une action de façon asynchrone</span>
            <span class="kt">var</span> <span class="n">obsAsync</span> <span class="p">=</span> <span class="n">Observable</span><span class="p">.</span><span class="nf">Start</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
                                 <span class="k">return</span> <span class="nf">findRandomFlickrImages</span><span class="p">(</span><span class="s">"techdays"</span><span class="p">);</span>
                                 <span class="p">});</span>

            <span class="c1">// On souscrit à notre objet observable</span>
            <span class="n">obsAsync</span><span class="p">.</span><span class="nf">Subscribe</span><span class="p">(</span><span class="n">urls</span> <span class="p">=&gt;</span>
            <span class="p">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">();</span>
                <span class="c1">// chaque url est ecrit à la ligne dans la console</span>
                <span class="n">urls</span><span class="p">.</span><span class="nf">ToList</span><span class="p">()</span>
                    <span class="p">.</span><span class="nf">ForEach</span><span class="p">(</span><span class="n">s</span> <span class="p">=&gt;</span> <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">s</span><span class="p">));</span>
            <span class="p">});</span>

            <span class="c1">// une petite boucle histoire de montrer le thread principal</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">10000</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="n">i</span> <span class="p">+</span> <span class="s">" "</span><span class="p">);</span>
                <span class="c1">// sleep pour attendre 1sec entre chaque write</span>
                <span class="c1">// (c'est pas beau mais éfficace :p)</span>
                <span class="n">Thread</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="m">1000</span><span class="p">);</span>
            <span class="p">}</span>

        <span class="p">}</span>

        <span class="c1">// Renvoit une liste d'url de photos flickr (méthode synchrone)</span>
<span class="k">static</span> <span class="kt">string</span><span class="p">[]</span> <span class="nf">findRandomFlickrImages</span><span class="p">(</span><span class="kt">string</span> <span class="n">SearchTerm</span><span class="p">)</span>
<span class="p">{</span>
            <span class="kt">var</span> <span class="n">doc</span> <span class="p">=</span> <span class="n">XDocument</span><span class="p">.</span><span class="nf">Load</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="n">CultureInfo</span><span class="p">.</span><span class="n">InvariantCulture</span><span class="p">,</span>
                <span class="s">"http://api.flickr.com/services/feeds/photos_public.gne?tags={0}&amp;amp;amp;format=rss_200"</span><span class="p">,</span>
                <span class="n">HttpUtility</span><span class="p">.</span><span class="nf">UrlEncode</span><span class="p">(</span><span class="n">SearchTerm</span><span class="p">)));</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">doc</span><span class="p">.</span><span class="n">Root</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
                <span class="k">return</span> <span class="k">null</span><span class="p">;</span>

            <span class="kt">var</span> <span class="n">node_name</span> <span class="p">=</span> <span class="s">"{http://search.yahoo.com/mrss/}thumbnail"</span><span class="p">;</span>
            <span class="k">return</span> <span class="n">doc</span><span class="p">.</span><span class="n">Root</span><span class="p">.</span><span class="nf">Descendants</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
                <span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="nf">Attributes</span><span class="p">(</span><span class="s">"url"</span><span class="p">).</span><span class="nf">First</span><span class="p">().</span><span class="n">Value</span><span class="p">)</span>
                <span class="p">.</span><span class="nf">ToArray</span><span class="p">();</span>
<span class="p">}</span>
</code></pre>
  </div>
</div>

<p>Une petite explication s’impose.
J’utilise ici la classe statique <code class="highlighter-rouge">Observable</code> qui fournit toute une collection de méthodes très intéressantes dont une utilisé ici <code class="highlighter-rouge">Start&lt;T&gt;(Func&lt;T&gt; function)</code>.
Cette méthode permet d’invoquer très simplement une fonction et de créer un objet <code class="highlighter-rouge">Observable&lt;T&gt;</code>.
Comme dans les exemples précédents il suffit alors de souscrire à cet objet.
La boucle for juste en dessous n’est là que pour montrer l’exécution asynchrone de l’appel.</p>

<p>Le résultat est le suivant :</p>

<div class="language-bash highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code>0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
http://farm6.static.flickr.com/5216/5430163165_934253a6fd_s.jpg
http://farm6.static.flickr.com/5291/5430698546_ca476e7c13_s.jpg
http://farm6.static.flickr.com/5211/5430709040_e22b08f4fc_s.jpg
http://farm6.static.flickr.com/5132/5430096315_ff7395634d_s.jpg
http://farm6.static.flickr.com/5060/5430094263_4f13ddf9aa_s.jpg
http://farm6.static.flickr.com/5139/5430098535_d6cb589d88_s.jpg
http://farm6.static.flickr.com/5176/5430707044_234827e644_s.jpg
http://farm6.static.flickr.com/5219/5415845508_67bf02c09f_s.jpg
http://farm6.static.flickr.com/5046/5260623309_f901b5b584_s.jpg
http://farm6.static.flickr.com/5004/5261221084_f770ff611b_s.jpg
http://farm6.static.flickr.com/5168/5261223046_2b2c730f8f_s.jpg
http://farm6.static.flickr.com/5090/5260626115_b74055a6c3_s.jpg
http://farm6.static.flickr.com/5083/5260624721_002c8c49be_s.jpg
http://farm6.static.flickr.com/5083/5260608677_df36a17e7c_s.jpg
http://farm6.static.flickr.com/5209/5260618487_a64e1190d2_s.jpg
http://farm6.static.flickr.com/5162/5261213374_abec64f27f_s.jpg
http://farm6.static.flickr.com/5166/5260619845_e309273ab6_s.jpg
http://farm6.static.flickr.com/5009/5261218048_16f0940af0_s.jpg
http://farm6.static.flickr.com/5206/5260610343_8a9c614f1d_s.jpg
http://farm6.static.flickr.com/5048/5342364163_219304361f_s.jpg
24 25 26 27 28 29 30 31 32 33 34 35 36
</code></pre>
  </div>
</div>

<p>Pas mal non ?
La programmation est assez simple finalement, on commence par coder de façon synchrone puis lorsque tout fonctionne on fait appel à la classe <code class="highlighter-rouge">Observable</code> par exemple pour créer un <code class="highlighter-rouge">IObservable</code> et s’y abonner :)</p>

<p>Mais ce n’est pas fini ! Allons encore un peu plus loin. Rx donne la possibilité de créer des <code class="highlighter-rouge">IObservable</code> directement à partir d’évènement.
Voici un petit exemple de ce qu’on peut faire pour créer un système de drag&amp;drop en Silverlight.</p>

<div class="language-csharp highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><span class="k">private</span> <span class="k">void</span> <span class="nf">UserControl_Loaded</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">RoutedEventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>

<span class="c1">// Créer un IObservable à partir de l'évènement MouseLeftButtonDown</span>
<span class="n">Func</span><span class="p">&lt;</span><span class="n">FrameworkElement</span><span class="p">,</span> <span class="n">IObservable</span><span class="p">&lt;</span><span class="n">IEvent</span><span class="p">&lt;</span><span class="n">MouseButtonEventArgs</span><span class="p">&gt;&gt;&gt;</span> <span class="n">mouseDown</span> <span class="p">=</span> <span class="n">element</span> <span class="p">=&gt;</span> <span class="n">Observable</span><span class="p">.</span><span class="n">FromEvent</span><span class="p">&lt;</span><span class="n">MouseButtonEventArgs</span><span class="p">&gt;(</span><span class="n">element</span><span class="p">,</span> <span class="s">"MouseLeftButtonDown"</span><span class="p">);</span>
<span class="c1">// Créer un IObservable à partir de l'évènement MouseLeftButtonUp</span>
<span class="n">Func</span><span class="p">&lt;</span><span class="n">FrameworkElement</span><span class="p">,</span> <span class="n">IObservable</span><span class="p">&lt;</span><span class="n">IEvent</span><span class="p">&lt;</span><span class="n">MouseButtonEventArgs</span><span class="p">&gt;&gt;&gt;</span> <span class="n">mouseUp</span> <span class="p">=</span> <span class="n">element</span> <span class="p">=&gt;</span> <span class="n">Observable</span><span class="p">.</span><span class="n">FromEvent</span><span class="p">&lt;</span><span class="n">MouseButtonEventArgs</span><span class="p">&gt;(</span><span class="n">element</span><span class="p">,</span> <span class="s">"MouseLeftButtonUp"</span><span class="p">);</span>
<span class="c1">// Créer un IObservable à partir de l'évènement MouseMove</span>
<span class="n">Func</span><span class="p">&lt;</span><span class="n">FrameworkElement</span><span class="p">,</span> <span class="n">IObservable</span><span class="p">&lt;</span><span class="n">IEvent</span><span class="p">&lt;</span><span class="n">MouseEventArgs</span><span class="p">&gt;&gt;&gt;</span> <span class="n">mouseMove</span> <span class="p">=</span> <span class="n">element</span> <span class="p">=&gt;</span> <span class="n">Observable</span><span class="p">.</span><span class="n">FromEvent</span><span class="p">&lt;</span><span class="n">MouseEventArgs</span><span class="p">&gt;(</span><span class="n">element</span><span class="p">,</span> <span class="s">"MouseMove"</span><span class="p">);</span>

<span class="c1">// Création d'une requête linq sur l'IObservable</span>
<span class="kt">var</span> <span class="n">draggingEventsImage</span> <span class="p">=</span> <span class="k">from</span> <span class="n">pos</span> <span class="k">in</span> <span class="nf">mouseMove</span><span class="p">(</span><span class="n">rectangle</span><span class="p">)</span>
                                <span class="p">.</span><span class="nf">SkipUntil</span><span class="p">(</span><span class="nf">mouseDown</span><span class="p">(</span><span class="n">rectangle</span><span class="p">)</span>
                                            <span class="p">.</span><span class="nf">Do</span><span class="p">(</span><span class="n">mb</span> <span class="p">=&gt;</span> <span class="n">rectangle</span><span class="p">.</span><span class="nf">CaptureMouse</span><span class="p">())</span>
                                            <span class="p">.</span><span class="nf">Do</span><span class="p">(</span><span class="n">mb</span> <span class="p">=&gt;</span> <span class="n">DropShadowStory1</span><span class="p">.</span><span class="nf">Begin</span><span class="p">())</span>
                                            <span class="p">)</span>
                                <span class="p">.</span><span class="nf">TakeUntil</span><span class="p">(</span><span class="nf">mouseUp</span><span class="p">(</span><span class="n">rectangle</span><span class="p">)</span>
                                            <span class="p">.</span><span class="nf">Do</span><span class="p">(</span><span class="n">mb</span> <span class="p">=&gt;</span> <span class="n">DropShadowStoryReverse1</span><span class="p">.</span><span class="nf">Begin</span><span class="p">())</span>
                                                <span class="p">.</span><span class="nf">Do</span><span class="p">(</span><span class="n">mb</span> <span class="p">=&gt;</span> <span class="n">rectangle</span><span class="p">.</span><span class="nf">ReleaseMouseCapture</span><span class="p">())</span>
                                            <span class="p">)</span>
            <span class="p">.</span><span class="nf">Let</span><span class="p">(</span><span class="n">mm</span> <span class="p">=&gt;</span> <span class="n">mm</span><span class="p">.</span><span class="nf">Zip</span><span class="p">(</span><span class="n">mm</span><span class="p">.</span><span class="nf">Skip</span><span class="p">(</span><span class="m">1</span><span class="p">),</span> <span class="p">(</span><span class="n">prev</span><span class="p">,</span> <span class="n">cur</span><span class="p">)</span> <span class="p">=&gt;</span>
                <span class="k">new</span>
                <span class="p">{</span>
                    <span class="n">X</span> <span class="p">=</span> <span class="n">cur</span><span class="p">.</span><span class="n">EventArgs</span><span class="p">.</span><span class="nf">GetPosition</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="n">X</span> <span class="p">-</span>
                        <span class="n">prev</span><span class="p">.</span><span class="n">EventArgs</span><span class="p">.</span><span class="nf">GetPosition</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="n">X</span><span class="p">,</span>
                    <span class="n">Y</span> <span class="p">=</span> <span class="n">cur</span><span class="p">.</span><span class="n">EventArgs</span><span class="p">.</span><span class="nf">GetPosition</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="n">Y</span> <span class="p">-</span>
                        <span class="n">prev</span><span class="p">.</span><span class="n">EventArgs</span><span class="p">.</span><span class="nf">GetPosition</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="n">Y</span>
                <span class="p">})).</span><span class="nf">Repeat</span><span class="p">()</span>
                            <span class="k">select</span> <span class="n">pos</span><span class="p">;</span>

<span class="c1">// Enfin on souscrit pour déplacer l'élément</span>
<span class="n">draggingEventsImage</span><span class="p">.</span><span class="nf">Subscribe</span><span class="p">(</span>
<span class="n">p</span> <span class="p">=&gt;</span>
<span class="p">{</span>
<span class="n">Canvas</span><span class="p">.</span><span class="nf">SetLeft</span><span class="p">(</span><span class="n">rectangle</span><span class="p">,</span> <span class="n">Canvas</span><span class="p">.</span><span class="nf">GetLeft</span><span class="p">(</span><span class="n">rectangle</span><span class="p">)</span> <span class="p">+</span> <span class="n">p</span><span class="p">.</span><span class="n">X</span><span class="p">);</span>
<span class="n">Canvas</span><span class="p">.</span><span class="nf">SetTop</span><span class="p">(</span><span class="n">rectangle</span><span class="p">,</span> <span class="n">Canvas</span><span class="p">.</span><span class="nf">GetTop</span><span class="p">(</span><span class="n">rectangle</span><span class="p">)</span> <span class="p">+</span> <span class="n">p</span><span class="p">.</span><span class="n">Y</span><span class="p">);</span>
<span class="p">});</span>

<span class="p">}</span>
</code></pre>
  </div>
</div>

<p>Whoua !
Expliquons quand même la requête qui semble tiré par les cheveux.</p>

<div class="language-csharp highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><span class="k">from</span> <span class="n">pos</span> <span class="k">in</span> <span class="nf">mouseMove</span><span class="p">(</span><span class="n">rectangle</span><span class="p">)</span>
</code></pre>
  </div>
</div>
<p>Récupère un IObservable à partir de MouseMove sur le rectangle</p>

<div class="language-csharp highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><span class="p">.</span><span class="nf">SkipUntil</span><span class="p">(</span><span class="nf">mouseDown</span><span class="p">(</span><span class="n">rectangle</span><span class="p">)</span>
</code></pre>
  </div>
</div>
<p>Ignore les valeur tant que le MouseLeftButtonDown n’a pas renvoyé d’info</p>

<div class="language-csharp highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><span class="p">.</span><span class="nf">Do</span><span class="p">(</span><span class="n">mb</span> <span class="p">=&gt;</span> <span class="n">rectangle</span><span class="p">.</span><span class="nf">CaptureMouse</span><span class="p">())</span>
</code></pre>
  </div>
</div>
<p>Capture la souris pour permettre de faire fonctionner correctement le drag ..</p>

<div class="language-csharp highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><span class="p">.</span><span class="nf">Do</span><span class="p">(</span><span class="n">mb</span> <span class="p">=&gt;</span> <span class="n">DropShadowStory1</span><span class="p">.</span><span class="nf">Begin</span><span class="p">())</span>
</code></pre>
  </div>
</div>
<p>Lance le storyboard sur le rectangle
Les deux .Do() sont executés lors du MouseLeftButtonDown</p>

<div class="language-csharp highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><span class="p">.</span><span class="nf">TakeUntil</span><span class="p">(</span><span class="nf">mouseUp</span><span class="p">(</span><span class="n">rectangle</span><span class="p">)</span>
</code></pre>
  </div>
</div>
<p>Utiliser les valeurs tant que MouseLeftButtonUp n’a pas renvoyé d’infos</p>

<div class="language-csharp highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><span class="p">.</span><span class="nf">Do</span><span class="p">(</span><span class="n">mb</span> <span class="p">=&gt;</span> <span class="n">DropShadowStoryReverse1</span><span class="p">.</span><span class="nf">Begin</span><span class="p">())</span>
</code></pre>
  </div>
</div>
<p>Lance le storyboard inverse sur le rectangle</p>

<div class="language-csharp highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><span class="p">.</span><span class="nf">Do</span><span class="p">(</span><span class="n">mb</span> <span class="p">=&gt;</span> <span class="n">rectangle</span><span class="p">.</span><span class="nf">ReleaseMouseCapture</span><span class="p">())</span>
</code></pre>
  </div>
</div>
<p>Relache la souris, Les deux .Do() sont executés lors du MouseLeftButtonUp</p>

<div class="language-csharp highlighter-rouge">
  <div class="highlight">
    <pre class="highlight"><code><span class="p">.</span><span class="nf">Let</span><span class="p">(</span><span class="n">mm</span> <span class="p">=&gt;</span> <span class="n">mm</span><span class="p">.</span><span class="nf">Zip</span><span class="p">(</span><span class="n">mm</span><span class="p">.</span><span class="nf">Skip</span><span class="p">(</span><span class="m">1</span><span class="p">),</span> <span class="p">(</span><span class="n">prev</span><span class="p">,</span> <span class="n">cur</span><span class="p">)</span> <span class="p">=&gt;</span>
                <span class="k">new</span>
                <span class="p">{</span>
                    <span class="n">X</span> <span class="p">=</span> <span class="n">cur</span><span class="p">.</span><span class="n">EventArgs</span><span class="p">.</span><span class="nf">GetPosition</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="n">X</span> <span class="p">-</span>
                        <span class="n">prev</span><span class="p">.</span><span class="n">EventArgs</span><span class="p">.</span><span class="nf">GetPosition</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="n">X</span><span class="p">,</span>
                    <span class="n">Y</span> <span class="p">=</span> <span class="n">cur</span><span class="p">.</span><span class="n">EventArgs</span><span class="p">.</span><span class="nf">GetPosition</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="n">Y</span> <span class="p">-</span>
                        <span class="n">prev</span><span class="p">.</span><span class="n">EventArgs</span><span class="p">.</span><span class="nf">GetPosition</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="n">Y</span>
                <span class="p">})).</span><span class="nf">Repeat</span><span class="p">()</span>
                            <span class="k">select</span> <span class="n">pos</span><span class="p">;</span>
</code></pre>
  </div>
</div>

<p>Tout ce bloc permet de sélectionner le déplacement entre deux points.
La méthode Zip prend deux séquences pour les assembler en une seule, il faut donc sauter la première séquence puisque la valeur précédente n’existe pas.
Ensuite un simple calcule est effectué.</p>

<p>Dans le subscribe il suffit d’appliquer le déplacement et le tour est joué.</p>

<p>Bon je vous l’accorde ça ne sert clairement à rien, ce n’est que pour la démo. On peut arriver exactement au même résultat en ajoutant un simple <code class="highlighter-rouge">MouseDragElementBehavior</code> sur notre élément.</p>

    </section>

    <footer class="post-footer">
      <section class="share">
        <a class="icon" href="https://twitter.com/intent/tweet?url=https://www.evilznet.com/2011/02/11/techdays-2011-la-programmation-asynchrone-part-i-reactive-extensions&text=TechDays+2011%2C+LA+PROGRAMMATION+ASYNCHRONE+-+PART+I+-+REACTIVE+EXTENSIONS&via=Evilznet" target="_blank">
          Share on
          <svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>

        </a>

        <a class="subscribe" href="/feed.xml"> <span class="tooltip"> <i class="fa fa-rss"></i> RSS feed.</span></a>
      </section>
    </footer>
    <div class="bottom-teaser cf">
      <div class="isLeft">
        <h5 class="index-headline featured"><span>Written by</span></h5>
        <section class="author">
          <div class="author-image"></div>
          <h4>Vincent Bourdon</h4>
          <p class="bio">.Net Dev since 2001
</p>

          <p>
            <span>
              
                
<span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><a href="https://github.com/evilz"><span class="username">evilz</span></a>


              
            </span>

            <span>
              
                
<span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><a href="https://twitter.com/Evilznet"><span class="username">Evilznet</span></a>


              
            </span>
          </p>
          <hr>
          <p class="published">Published <time datetime="2011-02-11 08:49">11 Feb 2011</time></p>
        </section>
      </div>
      <div class="isRight">
          <h5 class="index-headline featured"><span>A lire aussi</span></h5>

          <footer class="site-footer">
              <section class="poweredby">
                
 <!-- Pagination links -->
 <div class="PageNavigation">
    
      <a class="prev" href="/2011/02/07/web-garden/">&laquo; Web garden</a>
      

      
    
    
    
      <a class="next" href="/2011/03/29/microsoft-webcamp-html5/">Microsoft WebCamp HTML5 &raquo;</a>
        
        
        
        <div class="flex">
          <div class="fixed-footer m1">

            <amp-img src="https://farm5.staticflickr.com/4725/25472196478_bbc5f1f6a6_m.jpg"
            width="50"
            height="50"
            layout="fill"
            class="cover"
            alt="AMP"></amp-img>
        </div>
      </div>
        

      
    
  </div>

              </section>
             
             
            
            </footer>

       

        
      </div>
    </div>
  </article>
</main>

    
    <amp-analytics type="googleanalytics" id="amp-analytics">
<script type="application/json">
{
  "vars": {
    "account": "UA-2063306-2"
  },
  "triggers": {
    "trackPageview": {
      "on": "visible",
      "request": "pageview"
    }
  }
}
</script>
</amp-analytics>


<amp-install-serviceworker
    src="/serviceworker.js"
    layout="nodisplay">
</amp-install-serviceworker>    

<amp-gist
data-gistid="ccabc534e91280364fcbe9b775a551a9"
data-file="empty"
layout="fixed-height"
height="0">
</amp-gist>

  </body>
</html>
